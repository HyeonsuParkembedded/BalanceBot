네, 현재의 매우 전문적인 프로젝트 구조에 맞춰 README 파일을 작성해 드릴게요. 이 README는 프로젝트의 높은 완성도와 뛰어난 아키텍처를 강조하여 다른 개발자들에게 깊은 인상을 줄 수 있도록 구성했습니다.

아래 내용을 복사하여 `README.md` 파일에 붙여넣으세요.

-----

# BalanceBot: 전문적인 아키텍처 기반의 ESP32 균형 로봇

이 프로젝트는 **ESP32-S3**를 기반으로 한 2륜 균형 로봇(Self-Balancing Robot)입니다. 단순한 기능 구현을 넘어, **AUTOSAR(오토사)와 유사한 계층형 소프트웨어 아키텍처**를 적용하여 코드의 **이식성, 재사용성, 테스트 용이성**을 극대화한 것이 특징입니다.

FreeRTOS를 활용한 실시간 멀티태스킹, 칼만 필터를 이용한 정밀한 센서 융합, 그리고 중앙 상태 머신을 통한 안정적인 동작 제어 등 상용 제품 수준의 임베디드 소프트웨어 설계를 경험할 수 있습니다.

## ✨ 주요 특징 (Key Features)

  * **전문적인 소프트웨어 아키텍처:** 하드웨어 제어를 담당하는 **BSW(기반 소프트웨어) 계층**과 실제 로직을 담당하는 \*\*애플리케이션 계층(Input, Logic, Output)\*\*을 완벽하게 분리하여 이식성과 유지보수성을 극대화했습니다.
  * **실시간 제어 시스템:** **FreeRTOS**를 사용하여 센서 데이터 처리, 균형 제어, 상태 모니터링 등 여러 작업을 독립적인 Task로 분리하여 안정적인 실시간 성능을 보장합니다.
  * **안정적인 상태 관리:** `IDLE`, `BALANCING`, `FALLEN` 등 로봇의 모든 동작을 관리하는 \*\*중앙 상태 머신(State Machine)\*\*을 구현하여 예외 상황에서도 예측 가능하고 안정적으로 동작합니다.
  * **정밀한 센서 융합:** IMU(MPU6050) 센서의 가속도계와 자이로스코프 데이터를 **칼만 필터(Kalman Filter)** 알고리즘으로 융합하여 노이즈를 최소화하고 정확한 기울기 각도를 측정합니다.
  * **단위 테스트 환경:** PlatformIO의 **네이티브(Native) 테스트 환경**을 구축하여, 실제 하드웨어 없이 PC에서도 PID 제어기, 칼만 필터 등 핵심 로직을 검증할 수 있습니다.
  * **중앙 집중식 설정:** 모든 하드웨어 핀, PID 상수, 시스템 파라미터를 **`config.h` 파일에서 중앙 관리**하여 튜닝 및 수정이 매우 용이합니다.

## 🏗️ 소프트웨어 아키텍처

이 프로젝트는 다음과 같은 4개의 계층으로 명확하게 분리되어 있습니다.

1.  **BSW (Basic Software):** 하드웨어 제어 계층

      * MCU의 주변장치(I2C, UART, PWM 등)를 직접 제어하는 드라이버 코드입니다.
      * 하드웨어에 대한 모든 종속성을 이 계층에 격리시켜 이식성을 극대화합니다.

2.  **Input (입력 계층):** 센서 데이터 가공

      * BSW를 통해 센서의 원본(Raw) 데이터를 읽어와 `Logic` 계층이 사용할 수 있는 물리량(각도, 속도 등)으로 변환합니다.

3.  **Logic (로직 계층):** 로봇의 두뇌

      * `Input` 계층의 데이터를 바탕으로 PID 제어, 칼만 필터 등 핵심 알고리즘을 수행하여 로봇이 "무엇을 할지" 결정합니다.
      * 이 계층은 하드웨어와 완전히 독립적입니다.

4.  **Output (출력 계층):** 행동 제어

      * `Logic` 계층의 결정을 받아 BSW를 통해 실제 모터, 서보 등 액추에이터를 구동합니다.

## 🛠️ 개발 환경 및 빌드

이 프로젝트는 **PlatformIO**를 사용하여 개발되었습니다.

### 1\. ESP32 펌웨어 빌드 및 업로드

```bash
# 프로젝트 빌드
pio run -e esp32-s3-devkitc-1

# 펌웨어 업로드
pio run -e esp32-s3-devkitc-1 -t upload

# 시리얼 모니터 실행
pio device monitor -e esp32-s3-devkitc-1
```

### 2\. PC 네이티브 단위 테스트 실행

핵심 로직(PID, 칼만 필터 등)은 하드웨어 없이 PC에서 직접 테스트할 수 있습니다.

```bash
# 네이티브 환경에서 단위 테스트 실행
pio test -e native -v
```

## ⚙️ 설정 및 튜닝

로봇의 모든 주요 설정은 `src/config.h` 파일에서 수정할 수 있습니다.

  * **하드웨어 핀 설정:** 모터, 엔코더, 센서의 GPIO 핀 번호
  * **제어 파라미터:** PID 제어 상수 (`Kp`, `Ki`, `Kd`)
  * **로봇 물리 제원:** 바퀴 지름, 엔코더 PPR 등

<!-- end list -->

```c
// src/config.h 예시

// PID Controller tuning
#define CONFIG_BALANCE_PID_KP           50.0f
#define CONFIG_BALANCE_PID_KI           0.5f
#define CONFIG_BALANCE_PID_KD           2.0f

// Left motor pins
#define CONFIG_LEFT_MOTOR_A_PIN         GPIO_NUM_4
#define CONFIG_LEFT_MOTOR_B_PIN         GPIO_NUM_5
```

## 📜 라이선스

이 프로젝트는 [MIT 라이선스](https://www.google.com/search?q=LICENSE)를 따릅니다.
